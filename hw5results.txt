>> A = [[1 2 3 -4 -5]' [6 7 8 -9 -10]' [11 12 13 -14 -15]']

A =

     1     6    11
     2     7    12
     3     8    13
    -4    -9   -14
    -5   -10   -15

>> [U,S,V] = kogbetliantz(A)

U =

    0.3546   -0.6887   -0.0068   -0.1902   -0.6031
    0.3987   -0.3756    0.4980   -0.0423    0.6709
    0.4428   -0.0624   -0.4711    0.7538    0.0992
   -0.4870   -0.2507    0.5247    0.6198   -0.2014
   -0.5311   -0.5638   -0.5046   -0.0985    0.3684


S =

   35.1272    0.0000   -0.0000
    0.0000    2.4654    0.0000
    0.0000    0.0000    0.0000
         0   -0.0000    0.0000
         0   -0.0000   -0.0000


V =

    0.2017    0.8903    0.4082
    0.5168    0.2573   -0.8165
    0.8320   -0.3757    0.4082

>> U * S * transpose(V)

ans =

    1.0000    6.0000   11.0000
    2.0000    7.0000   12.0000
    3.0000    8.0000   13.0000
   -4.0000   -9.0000  -14.0000
   -5.0000  -10.0000  -15.0000

>> svd(A)

ans =

   35.1272
    2.4654
    0.0000

>> norm(U * S * transpose(V) - A, 2)

ans =

   2.1791e-14

>> norm(U * transpose(U) - eye(size(U)), 2)

ans =

   1.4848e-15

>> norm(transpose(V) * V - eye(size(V)), 2)

ans =

   8.8763e-16

>> moorepenrose(A)

ans =

   -0.2467   -0.1333   -0.0200   -0.0933   -0.2067
   -0.0667   -0.0333   -0.0000   -0.0333   -0.0667
    0.1133    0.0667    0.0200    0.0267    0.0733

>> pinv(A)

ans =

   -0.2467   -0.1333   -0.0200   -0.0933   -0.2067
   -0.0667   -0.0333    0.0000   -0.0333   -0.0667
    0.1133    0.0667    0.0200    0.0267    0.0733

>> A*moorepenrose(A)*A

ans =

    1.0000    6.0000   11.0000
    2.0000    7.0000   12.0000
    3.0000    8.0000   13.0000
   -4.0000   -9.0000  -14.0000
   -5.0000  -10.0000  -15.0000

>> moorepenrose(A) * A * moorepenrose(A)

ans =

   -0.2467   -0.1333   -0.0200   -0.0933   -0.2067
   -0.0667   -0.0333   -0.0000   -0.0333   -0.0667
    0.1133    0.0667    0.0200    0.0267    0.0733

>> transpose(A * moorepenrose(A))

ans =

    0.6000    0.4000    0.2000    0.0000    0.2000
    0.4000    0.3000    0.2000   -0.1000   -0.0000
    0.2000    0.2000    0.2000   -0.2000   -0.2000
   -0.0000   -0.1000   -0.2000    0.3000    0.4000
    0.2000    0.0000   -0.2000    0.4000    0.6000

>> A * moorepenrose(A)

ans =

    0.6000    0.4000    0.2000   -0.0000    0.2000
    0.4000    0.3000    0.2000   -0.1000    0.0000
    0.2000    0.2000    0.2000   -0.2000   -0.2000
    0.0000   -0.1000   -0.2000    0.3000    0.4000
    0.2000   -0.0000   -0.2000    0.4000    0.6000

>> transpose(moorepenrose(A) * A)

ans =

    0.8333    0.3333   -0.1667
    0.3333    0.3333    0.3333
   -0.1667    0.3333    0.8333

>> moorepenrose(A) * A

ans =

    0.8333    0.3333   -0.1667
    0.3333    0.3333    0.3333
   -0.1667    0.3333    0.8333

>> b = [1 1 1 1 1]'

b =

     1
     1
     1
     1
     1

>> moorepenrose(A) * b

ans =

   -0.7000
   -0.2000
    0.3000

>> norm(b - A * moorepenrose(A) * b, 2)

ans =

    1.0954

>> moorepenrose_rank_one(A)

ans =

   -1.5096   -0.8220   -0.1345   -0.5531   -1.2407
   -0.4317   -0.2324   -0.0331   -0.1662   -0.3655
    0.6462    0.3573    0.0683    0.2207    0.5096

>> pinv(A)

ans =

   -0.2467   -0.1333   -0.0200   -0.0933   -0.2067
   -0.0667   -0.0333    0.0000   -0.0333   -0.0667
    0.1133    0.0667    0.0200    0.0267    0.0733

>> A * moorepenrose_rank_one(A) * A

ans =

   -6.6765    3.7812   14.2390
   -2.1861    5.7901   13.7663
    2.3042    7.7989   13.2936
   -6.7945   -9.8077  -12.8209
  -11.2849  -11.8165  -12.3482

>> moorepenrose_rank_one(A) * A * moorepenrose_rank_one(A)

ans =

   -9.1861   -5.0082   -0.8303   -3.3476   -7.5256
   -2.6505   -1.4423   -0.2342   -0.9739   -2.1821
    3.8852    2.1235    0.3619    1.3998    3.1614

>> transpose(A * moorepenrose_rank_one(A))

ans =

    3.0085    1.7134    0.4183    0.8768    2.1719
    1.7134    1.0162    0.3190    0.3781    1.0753
    0.4183    0.3190    0.2198   -0.1205   -0.0213
    0.8768    0.3781   -0.1205    0.6192    1.1179
    2.1719    1.0753   -0.0213    1.1179    2.2144

>> A * moorepenrose_rank_one(A)

ans =

    3.0085    1.7134    0.4183    0.8768    2.1719
    1.7134    1.0162    0.3190    0.3781    1.0753
    0.4183    0.3190    0.2198   -0.1205   -0.0213
    0.8768    0.3781   -0.1205    0.6192    1.1179
    2.1719    1.0753   -0.0213    1.1179    2.2144

>> transpose(moorepenrose_rank_one(A) * A)

ans =

    4.8586    1.4968   -1.8651
    1.4968    0.6696   -0.1576
   -1.8651   -0.1576    1.5499

>> moorepenrose_rank_one(A) * A

ans =

    4.8586    1.4968   -1.8651
    1.4968    0.6696   -0.1576
   -1.8651   -0.1576    1.5499

>> moorepenrose_rank_one(A) * b

ans =

   -4.2599
   -1.2289
    1.8020

>> norm(b - A * moorepenrose_rank_one(A) * b, 2)

ans =

    9.9185

>> moorepenrose_rank_three(A)

ans =

   1.0e+14 *
   -1.5075    2.5304   -0.2483    1.0646   -0.2900
    3.0150   -5.0607    0.4965   -2.1292    0.5800
   -1.5075    2.5303   -0.2483    1.0646   -0.2900

>> pinv(A)

ans =

   -0.2467   -0.1333   -0.0200   -0.0933   -0.2067
   -0.0667   -0.0333    0.0000   -0.0333   -0.0667
    0.1133    0.0667    0.0200    0.0267    0.0733


